# Chapter 13 다이제스트 인증

## 특징
1. 비밀번호를 평문으로 전송 하지 않음
2. 인증 체결을 가로채서 재현하거나 위조를 하려는 행위 차단
3. 알려진 형태의 공격을 막음

### 요약 사용
- 클라이언트와 서버 상에서 계산한 키 값을 각자가 가지고 있는 메소드를 사용했을때 일치할 경우

### 단방향 요약
- 정보 본문의 압축
- 32글자의 16진수 문자로 표현

### 난스 사용
- OTP 같은 원리
- 주기적으로 요약을 바꾸게 만들어 전달

### 다이제스트 인증 핸드셰이크
1. 서버가 난스 생성 및 알고리즘 전달
2. 클라이언트가 응답 요약
3. 서버가 다음 번 난스 생성 및 전달

- 질문 거리 : 그렇다면 난스 생성 알고리즘은? / 뒤에 나옴

## 요약 계산
- H : 단방향 해시 함수
- KD : 요약 함수 (s : 시크릿 키, d : 데이터)
- A1(비밀번호 등 데이터), A2 (속성) 데이터는 요약을 생성하기 위해 H, KD에 의해 처리
- H(data) = MD5(data)
- KD(s, d) = H(연결(s:d))

### A1 보안 관련 데이터

- MD5 : 단방향 관련 해시
- MD5-sess : 해시 결과 뒤에 난스를 붙이면 A1

### A2 메시지 관련 데이터

- qop 형태에 따라 전달해야 하는 URL을 설정할 수 있음

## 난스 생성

- 난스의 수명을 횟수나 타임으로 제한 가능

## 보호 수준 향상
- 데이터 무결성을 검사하기 위해 값을 정의
- 인증을 의미하는 auth
- 인증 및 무결성 보호를 의미하는 auth-int

## 실제 상황에서는?

### 다중 인증 요구

- 하나의 리소스에 대해서 여러 인증만 요청

### 오류 처리

- 지시자나 값이 적절하지 않거나 요구된 지시자가 빠져있는 경우 400 Bad Request 에러를 반환

### 보호 공간

- A라는 공간 안에 진입할 때 인증을 처리 했을 경우 A 공간의 다른 서버에 접속 할 때 그 보호 공간에 없어도 사용 가능

### URI 다시 쓰기

- 호스트 명은 리소스에 영향을 주지 않고 URI 끝에 붙거나 중간에 삽입

### 캐시

- Cache-Control 중 must-revalidate 지시자일 경우 재점검을 수행
- public 지시자인 경우 임의의 요청에 대한 반환 될 수 있음

## 보안 고려 사항

### 헤더 부당 변경

- 헤더에 대한 디지털 서명

### 재전송 공격

- 타 트랜잭션에서 승인된 정보를 중복 사용
- 방지하기 위해서는 트랜잭션 마다 다른 난스 생성 (서버 부하 가능 위험도)

### 다중 인증 매커니

- 인증 여러 개 쓰기

### 사전 공격

- 단순한 비밀번호 쓰고, 난스가 단순하다면 쉽게 수집 가능


